/*! Educational planning application#0.0.1 Copyright ASV*/
"use strict";angular.module("edup.common",["restangular","angularUtils.directives.dirPagination"]),angular.module("edup.common").directive("appModal",function(){return{restrict:"A",link:function(a,b){a.dismissModal=function(){b.modal("hide")},a.showModal=function(){b.modal("show")}}}}),angular.module("edup.common").directive("edupToggle",["$timeout",function(a){return{restrict:"E",templateUrl:"edup-toggle",scope:{onEvent:"&",offEvent:"&",onLabel:"@",offLabel:"@",toggleId:"@",linkWidget:"="},controller:["$scope",function(){}],link:function(b){a(function(){b.onLabel||(b.onLabel="On"),b.offLabel||(b.offLabel="Off");var a=$("#"+b.toggleId);a.bootstrapToggle(),a.change(function(){$(this).prop("checked")?b.onEvent():b.offEvent()})})}}}]),angular.module("edup.common").directive("windowSize",["$document","$window",function(a,b){return{restrict:"A",link:function(c){var d=b.innerHeight||a.body.clientHeight,e=$("#edupHeader").height();c.viewScrollPaneHeight=d-e-40,console.log(c.viewScrollPaneHeight)}}}]),angular.module("edup.common").filter("toJson",function(){return function(a,b){return angular.toJson(a,b)}}),angular.module("edup.common").config(["paginationTemplateProvider",function(a){var b,c=window.location.hostname;b=c.indexOf("127.0.0.1")>-1?"http://127.0.0.1:8088/":"http://"+c+":8484/edup/ng",a.setPath(b+"/vendor/bower_components/angular-utils-pagination/dirPagination.tpl.html")}]),angular.module("edup.common").run(["Restangular","UrlService","NotificationService",function(a,b,c){a.setBaseUrl(b.BaseUrl+"/api"),a.setErrorInterceptor(function(a){var b="";return 400===a.status?_.forEach(a.data.errors,function(a){b+=a.message+",\n\n"}):b="Failed on: "+a.config.method+" to: "+a.config.url,c.Error(b),!0}),a.setRestangularFields({etag:"versionId"}),a.setDefaultHeaders({"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"})}]),angular.module("edup.common").service("NotificationService",function(){return alertify.set("notifier","position","bottom-right"),{Success:function(a){alertify.success(a)},Info:function(a){alertify.message(a)},Error:function(a){alertify.error(a)}}}),angular.module("edup.common").service("PaginationService",function(){var a=function(a){return a.page?a.page*a.perPage:1*a.perPage},b=function(a){return a.page?a.page*a.perPage-a.perPage:1*a.perPage-a.perPage};return{Top:a,Skip:b}}),angular.module("edup.common").service("QueryBuilderService",function(){function a(){}return new a}),angular.module("edup.common").service("QueryService",function(){var a=function(a,b,c,d,e,f){var g={};return g.$count=!0,a&&(g.$top=a),a&&(g.$skip=b),a&&(g.$search=c),d&&(g.$orderby=d),e&&(g.$filter=e),f&&(g.count=f),g};return{Query:a}}),angular.module("edup.common").service("RestService",["Restangular",function(a){var b=a.one("private"),c=a.one("public");return{Private:{Students:b.one("students"),Balance:b.one("balance"),Documents:b.one("documents"),LogOut:b.one("logout"),Subjects:b.one("subjects")},Public:{Ping:c.one("ping"),Login:c.one("login")}}}]),angular.module("edup.common").service("TypeAheadService",["UrlService",function(a){var b=a.Subjects,c={},d=function(a){c=a.values;var b=_.pluck(a.values,"subjectName");return b},e=function(){var a=new Bloodhound({datumTokenizer:function(a){return Bloodhound.tokenizers.whitespace(a.value)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,remote:{url:b+"?$count=true&$orderby=Created+desc&$search=%QUERY&$skip=0&$top=999&count=true",filter:d,wildcard:"%QUERY"}});return a.initialize(),a};return{Build:e,DataSet:function(){return c}}}]),angular.module("edup.common").service("UrlService",function(){var a,b=window.location.hostname;return a=b.indexOf("127.0.0.1")>-1?"http://localhost:8484/edup":"http://"+b+":8484/edup",{BaseUrl:a,Files:{Info:a+"/api/private/files",Upload:a+"/api/private/files/upload",Download:a+"/api/private/files/download"},Subjects:a+"/api/private/subjects",Reports:{Events:a+"/api/private/reports/visiting/plan/subject"}}}),angular.module("edup.login",[]),angular.module("edup.login").directive("edupLogin",function(){return{restrict:"E",templateUrl:"edup-login",controller:["$scope","$window","RestService","UrlService","NotificationService",function(a,b,c,d){a.submitLogin=function(a,e){c.Public.Login.customPOST("j_username="+a+"&j_password="+e,void 0,{},{"Content-Type":"application/x-www-form-urlencoded"}).then(function(){b.location.href=d.BaseUrl})}}],link:function(){}}}),angular.module("edup.header",["ui.router"]),angular.module("edup.header").directive("edupHeader",function(){return{restrict:"E",templateUrl:"edup-header",controller:["$scope","$window","$location","RestService","UrlService",function(a,b,c,d,e){a.isActive=function(a){return a===c.path()},a.logoutUser=function(){d.Private.LogOut.post().then(function(){b.location.href=e.BaseUrl})}}],link:function(){}}}),angular.module("edup.header").controller("NavbarController",["$scope","$state","RestService",function(a,b,c){a.application={version:"     "},c.Public.Ping.get().then(function(b){a.application.version=b.payload.version}),a.appModel={items:["Students","Subjects","Calendar"],states:["students","subjects","calendar"],current:0},a.$watch(function(){return a.appModel.current},function(c){b.go(a.appModel.states[c])})}]),angular.module("edup.footer",[]),angular.module("edup.footer").controller("FooterController",["$scope","$location","Restangular",function(a,b,c){c.one("ping").get().then(function(b){a.appVersion=b.version})}]),angular.module("edup.footer").directive("edupFooter",function(){return{restrict:"E",templateUrl:"edup-footer",link:function(){}}}),angular.module("edup.calendar",["mwl.calendar","ui.bootstrap","ngAnimate"]),angular.module("edup.calendar").controller("CalendarController",["$scope","$modal","moment","calendarTitle",function(a,b,c,d){function e(a,c){b.open({templateUrl:"modalContent.html",controller:["$scope","$modalInstance",function(b,d){b.$modalInstance=d,b.action=a,b.event=c}]})}var f=function(){a.currentDay=d.month()};f(),a.calendarView="month",a.calendarDay=new Date,a.events=[{title:"My event title",type:"info",startsAt:c().subtract(2,"day").toDate(),endsAt:c().add(2,"days").toDate(),editable:!1,deletable:!1,incrementsBadgeTotal:!0},{title:"This some strange warning event",type:"warning",startsAt:c().startOf("week").subtract(2,"days").add(8,"hours").toDate(),endsAt:c().startOf("week").add(1,"week").add(9,"hours").toDate()},{title:"Information event",type:"info",startsAt:c().subtract(1,"day").toDate(),endsAt:c().add(5,"days").toDate()},{title:"This is a really long and importnat event title",type:"important",startsAt:c().startOf("day").add(5,"hours").toDate(),endsAt:c().startOf("day").add(19,"hours").toDate()}],a.eventClicked=function(b){a.currentDay=this.calendarTitle,e("Clicked",b)},a.eventEdited=function(b){a.currentDay=this.calendarTitle,e("Edited",b)},a.eventDeleted=function(b){a.currentDay=this.calendarTitle,e("Deleted",b)},a.toggle=function(a,b,c){a.preventDefault(),a.stopPropagation(),c[b]=!c[b]},a.setCalendarView=function(b){a.calendarView=b,a.currentDay=this.calendarTitle},a.updateTitle=function(){a.currentDay=this.calendarTitle}}]),angular.module("edup.calendar").directive("Ñalendar",function(){return{restrict:"E",templateUrl:"calendar",link:function(){}}}),angular.module("edup.students",[]),angular.module("edup.students").directive("studentAccounting",function(){return{restrict:"E",templateUrl:"student-accounting",controller:["$scope","RestService","NotificationService",function(a,b,c){a.updateStudentBalance=function(d,e){if(d&&d.amount){var f={studentId:e.id,amount:100*d.amount,comments:d.comment,cash:d.cash?d.cash:!0};b.Private.Balance.customPOST(f).then(function(b){var f=b.payload;f&&(e.balance+=d.amount,a.balance=null,c.Success(d.amount+" EUR was added to "+e.name+" "+e.lastName+" student!"))})}}}],link:function(){}}}),angular.module("edup.students").directive("studentAttendance",function(){return{restrict:"E",templateUrl:"student-attendance",controller:function(){},link:function(){}}}),angular.module("edup.students").directive("balanceModal",["RestService","NotificationService",function(a,b){return{restrict:"E",templateUrl:"balance-modal",link:function(c){c.balanceUpdateInProgress=!1,c.price={amount:0,cash:!0},c.saving=function(d){if(!c.balanceUpdateInProgress&&d&&d.amount){c.balanceUpdateInProgress=!0;var e={studentId:c.selectedStudent.id,amount:100*d.amount,comments:d.comment,cash:d.cash?d.cash:!0};a.Private.Balance.customPOST(e).then(function(a){var e=a.payload;e&&(c.selectedStudent.balance+=d.amount,c.balance=null,c.dismissModal(),b.Success(d.amount+" EUR was added to "+c.selectedStudent.name+" "+c.selectedStudent.lastName+" student!"),c.balanceUpdateInProgress=!1)},function(){c.balanceUpdateInProgress=!1})}},c.resetValue=function(){c.balance=null}}}}]),angular.module("edup.students").directive("studentDetails",function(){return{restrict:"E",templateUrl:"student-details",link:function(a){a.directiveTest="Student input forms"}}}),angular.module("edup.students").directive("studentDocuments",function(){return{restrict:"E",templateUrl:"student-documents",controller:["$scope","QueryService","RestService","PaginationService","UrlService",function(a,b,c,d,e){a.initDocumentsPagination=function(){a.documentsPaging={enabled:!1,page:1,perPage:5,totalRecords:0}},a.initDocumentsPagination(),a.documentsSearch={spin:!1},a.loadDocuments=function(d,f,g){a.basicSearch.spin=!0;var h=b.Query(d,f,g,"Created desc","StudentId eq "+a.selectedStudent.id);c.Private.Documents.get(h).then(function(b){a.documentsSearch.spin=!1,a.documentsPaging.totalRecords=b.count,a.documents=b.values,_.forEach(a.documents,function(a){a.link=e.Files.Download+"/"+a.fileId})})},a.refreshDocumentsList=function(){a.documents=null,a.initDocumentsPagination(),a.loadDocuments(d.Top(a.documentsPaging),d.Skip(a.documentsPaging))},a.documentsPageChanged=function(b,c){a.documentsSearch.spin||(a.documentsPaging.page=b,a.loadDocuments(d.Top(a.documentsPaging),d.Skip(a.documentsPaging),c))}}],link:function(a){a.onShowDownloadToggle=function(){a.showDownloadSection=!0,a.documentsButtonLabel="Hide"},a.offShowDownloadToggle=function(){a.showDownloadSection=!1,a.documentsButtonLabel="Show"},a.toggleDownloadSection=function(){a.showDownloadSection=!a.showDownloadSection,a.showDownloadSection?a.onShowDownloadToggle():a.offShowDownloadToggle()},a.offShowDownloadToggle()}}}),angular.module("edup.students").directive("editStudent",function(){return{restrict:"E",templateUrl:"edit-student",controller:["$scope","RestService","NotificationService","PaginationService",function(a,b,c,d){a.executeStudentUpdate=function(e){a.studentProcessingInProgress||(a.studentProcessingInProgress=!0,e.id=a.selectedStudent.id,e.versionId=a.selectedStudent.versionId,e.birthDate=new Date(e.birthDateString),e&&e.name&&e.lastName&&e.id&&e.versionId&&b.Private.Students.one(e.id.toString()).customPUT(e).then(function(b){a.newStudent=null,a.photoUrl=null,a.photoUploaded=!1,e.versionId=b.payload,c.Success(e.name+" "+e.lastName+" updated!"),a.loadStudents(e.id,d.Top(a.studentPaging),d.Skip(a.studentPaging),null),a.studentProcessingInProgress=!1},function(){a.studentProcessingInProgress=!1}))}}],link:function(){}}}),angular.module("edup.students").directive("fileUpload",["$window","$timeout","UrlService","FileUploader","NotificationService",function(a,b,c,d,e){return{restrict:"E",templateUrl:"file-upload",scope:!1,priority:10,controller:["$scope","$timeout","RestService",function(a,b,c){a.executeDocumentSave=function(a,b,d){if(a&&b){var f={fileId:b,studentId:a};c.Private.Documents.customPOST(f).then(function(){e.Success("Document "+d+" uploaded!")})}}}],link:function(f){f.uploader=new d({url:c.Files.Upload}),f.uploader.removeAfterUpload=!0,f.deleteItem=function(a){console.log("delete "+a)},f.openDownloadUrl=function(b){a.open(b,"_blank")},f.uploader.onSuccessItem=function(a,b){var c=b.payload.id;f.executeDocumentSave(f.selectedStudent.id,c,a._file.name)},f.uploader.onErrorItem=function(a,b){if(b&&b.errors.length>0){var c=_.pluck(b.errors,"message");e.Error("Failed to upload "+a._file.name+". "+(c||[]).join(","))}else e.Error("Failed to upload "+a._file.name)},f.uploader.onCompleteAll=function(){b(function(){f.refreshDocumentsList()},1e3)}}}}]),angular.module("edup.students").directive("studentIdentificationCard",function(){return{restrict:"E",templateUrl:"student-identification-card",link:function(){}}}),angular.module("edup.students").directive("studentsListHeader",function(){return{restrict:"E",templateUrl:"students-list-header",link:function(){}}}),angular.module("edup.students").directive("studentsList",function(){return{restrict:"E",templateUrl:"students-list",link:function(a){a.studentsSearch={studentRecordsFound:!0},a.openStudentDetailModal=function(){$("#student-details-modal-view").modal("show"),$('.nav-tabs a[href="#information"]').tab("show")}}}}),angular.module("edup.students").controller("StudentsController",["$scope","$timeout","$filter","RestService","PaginationService","QueryService",function(a,b,c,d,e,f){a.studentSelected=!1,a.basicSearch={spin:!1},a.studentPaging={enabled:!1,page:1,perPage:10,totalRecords:0},a.loadFullStudent=function(b){b&&(a.basicSearch.spin=!0,d.Private.Students.one(b.toString()).get().then(function(b){a.selectedStudent=b.payload,a.selectedStudent&&(a.studentEdit=_.cloneDeep(a.selectedStudent),a.studentEdit.birthDate&&(a.studentEdit.birthDateString=c("date")(new Date(a.studentEdit.birthDate),"yyyy-MM-dd")),a.selectedStudent.balance=b.payload.balance/100,a.studentSelected=!0,a.basicSearch.spin=!1)}))},a.loadStudents=function(b,c,e,g){a.basicSearch.spin=!0;var h=f.Query(c,e,g,"Created desc");d.Private.Students.get(h).then(function(c){a.students=c.values,_.forEach(a.students,function(a){a.fullName=a.name+" "+a.lastName}),a.studentPaging.totalRecords=c.count,a.studentsSearch||(a.studentsSearch={}),a.studentsSearch.studentRecordsFound=0!==c.count,a.students.length>0?a.loadFullStudent(b?b:a.students[0].id):a.studentSelected=!1,a.basicSearch.spin=!1})},a.basicSearch.spin||a.loadStudents(null,e.Top(a.studentPaging),e.Skip(a.studentPaging)),a.setSelected=function(b){a.loadFullStudent(b)},a.addToBalance=function(a){console.log("Add new balance "+a)},a.studentsPageChanged=function(b,c){a.basicSearch.spin||(a.studentPaging.page=b,a.loadStudents(null,e.Top(a.studentPaging),e.Skip(a.studentPaging),c))},a.setRecordsPerPage=function(b){a.studentPaging.perPage=b};var g="";a.executeSearch=function(c){c&&c.length>2?b(function(){a.studentPaging.page=1,a.loadStudents(null,e.Top(a.studentPaging),e.Skip(a.studentPaging),c),g=c},300):_.isEmpty(c)&&g!==c&&b(function(){a.studentPaging.page=1,a.loadStudents(null,e.Top(a.studentPaging),e.Skip(a.studentPaging),null),g=c},300)}}]),angular.module("edup.students").directive("students",function(){return{restrict:"E",templateUrl:"students",link:function(a){a.directiveTest="Students tab directive"}}}),angular.module("edup.students").directive("newStudent",function(){return{restrict:"E",templateUrl:"new-student-modal",controller:["$scope","RestService","PaginationService","NotificationService",function(a,b,c,d){var e=function(){var a=$("#addNewStudentModalView");a&&a.modal("hide")};a.resetNewStudent=function(){a.$broadcast("clearFileUploadQueue",{message:"reset"}),a.newStudent&&(a.newStudent.birthDate=null,a.newStudent.photoUrl=null,a.newStudent.photoId=null),a.newStudent=null,a.photoUrl=null,a.photoUploaded=!1},a.executeStudentSave=function(f){a.studentProcessingInProgress||f&&f.name&&f.lastName&&(a.studentProcessingInProgress=!0,f.birthDate=new Date(f.birthDateString),b.Private.Students.customPOST(f).then(function(b){d.Success("Student "+f.name+" "+f.lastName+" created!"),a.loadStudents(b.payload,c.Top(a.studentPaging),c.Skip(a.studentPaging),null),a.resetNewStudent(),e(),a.studentProcessingInProgress=!1},function(){a.studentProcessingInProgress=!1}))},a.executeReset=function(){a.resetNewStudent()},a.executeCancel=function(){a.resetNewStudent(),e()}}],link:function(a){a.dismissNewStudentModalDialog=function(){a.dismissModal()}}}}),angular.module("edup.students").directive("photoUpload",["UrlService","FileUploader","$window","$timeout","NotificationService","RestService",function(a,b,c,d,e){return{restrict:"E",templateUrl:"photo-upload",scope:{photoId:"=",photoUrl:"="},priority:10,link:function(f){f.photoIsSelected=!1,f.uploader=new b({url:a.Files.Upload}),f.uploader.removeAfterUpload=!0,f.deleteItem=function(){f.photoIsSelected=!1},f.openDownloadUrl=function(a){c.open(a,"_blank")},f.handleItemRemoval=function(a){document.getElementById("photoUploader").value="",a.remove(),f.photoIsSelected=!1},f.$on("clearFileUploadQueue",function(){f.photoIsSelected=!1,f.uploader.clearQueue(),f.photoUploaded=!1}),f.uploader.onWhenAddingFileFailed=function(){f.photoIsSelected=!1},f.uploader.onAfterAddingFile=function(){f.photoIsSelected=!0},f.uploader.onAfterAddingAll=function(){f.photoIsSelected=!0},f.uploader.onSuccessItem=function(b,c){f.photoId=c.payload.id,f.photoUrl=a.Files.Download+"/"+f.photoId,e.Success("Student photo uploaded!"),d(function(){f.photoUploaded=!0,f.photoIsSelected=!1,document.getElementById("photoUploader").value=""},500)},f.uploader.onErrorItem=function(){e.Error("Failed to upload student photo!"),f.photoIsSelected=!1,document.getElementById("photoUploader").value=""},f.uploader.onCancelItem=function(){f.photoIsSelected=!1,document.getElementById("photoUploader").value=""}}}}]),angular.module("edup.subjects",[]),angular.module("edup.subjects").directive("eventInfo",function(){return{restrict:"E",templateUrl:"event-info",controller:["$scope","moment","RestService","QueryService",function(a,b,c,d){a.studentsManagemnt={expanded:!1},a.selectedEvent={loaded:!1},a.loadEventDetails=function(d){d&&c.Private.Subjects.one("events").one(d.toString()).get().then(function(c){c.payload&&(a.selectedEvent=c.payload,a.selectedEvent.loaded=!0,a.selectedEvent.adjustedPrice=a.selectedEvent.price/100,a.selectedEvent.havePassed=b().isAfter(a.selectedEvent.eventDate),a.resetEventStudentsSearch(a.selectedEvent.havePassed),a.loadAttendance(d))})},a.loadAttendance=function(b){if(b){var e=d.Query(999,0,"*",null,"EventId eq "+b,!1);c.Private.Subjects.one("events").one("attendance").get(e).then(function(b){a.eventStudentsSearch.attendance=b.values,a.executeSearch()})}},a.processExpand=function(){a.studentsManagemnt.expanded=!a.studentsManagemnt.expanded,a.executeSearch()}}],link:function(){}}}),angular.module("edup.subjects").directive("eventsHeader",function(){return{restrict:"E",templateUrl:"events-header",controller:["$scope","$timeout","$filter","moment","QueryService","RestService","TypeAheadService","NotificationService",function(a,b,c,d,e,f,g,h){a.subjects=[],a.selectedSubject=null;var i=function(b){a.selectedSubject=_.find(g.DataSet(),function(a){return a.subjectName===b}),a.selectedSubject&&(a.subjectEvent.subjectName=a.selectedSubject.subjectName)},j=g.Build(),k=$("#subject-event-typeahead .typeahead");k.typeahead({hint:!0,highlight:!0,minLength:1},{name:"subjectsTypeAhead",source:j}),k.bind("typeahead:selected",function(a,b){i(b)});var l=function(a){return a&&a.amount&&a.eventDate&&a.eventTimeFrom&&a.eventTimeTo?!0:!1},m=function(){k.typeahead("val",""),a.subjectEvent=null,a.selectedSubject=null},n=function(a,b){return c("date")(a,"yyyy-MM-dd")+" "+c("date")(b,"HH:mm")};a.renderDatePicker=function(a,b){_.forEach(b,function(a){d(a.utcDateValue).isBefore(d())&&(a.selectable=!1)})},a.renderTimePicker=function(a,b,c,d,e){c.selectable=!1,d.selectable=!1,e.selectable=!1},a.saveNewEvent=function(b){if(l(b)){var c=!1,d={};d.eventDate=b.eventDate,d.from=new Date(n(b.eventDate,b.eventTimeFrom)),d.to=new Date(n(b.eventDate,b.eventTimeTo)),d.price=100*b.amount,d.subject={},a.selectedSubject?(d.subject.subjectName=a.selectedSubject.subjectName,d.subject.subjectId=a.selectedSubject.subjectId,c=!0):_.isEmpty(b.subjectName)||(d.subject.subjectName=b.subjectName,c=!0),c?f.Private.Subjects.one("events").customPOST(d).then(function(){m(),h.Success(d.subject.subjectId?'Event have been registered to subject "'+d.subject.subjectName+'"':'New subject have been created.\n Event have been registered to subject "'+d.subject.subjectName+'"'),a.loadMoreEvens(!0)}):h.Error(angular.toJson(b,!0))}else console.log(angular.toJson(b,!0))},a.updateSelectedSubject=function(){a.subjectEvent||(a.subjectEvent={});var b=k.typeahead("val");a.selectedSubject?a.selectedSubject.subjectName===b?(console.log("value same in input and typeahead"),a.subjectEvent.subjectName=b):(console.log("value not same in input and typeahead"),a.selectedSubject=null,a.subjectEvent.subjectName=b):(console.log("typeahead not selected"),a.subjectEvent.subjectName=b)}}],link:function(){}}}),angular.module("edup.subjects").directive("eventsList",function(){return{restrict:"E",templateUrl:"events-list",controller:["$scope","$timeout","QueryService","RestService",function(a,b,c,d){a.events={values:[],total:0,loading:!1,firstLoad:!0,eventRecordsFound:!0},a.setSelected=function(b){a.events.firstLoad=!1,a.loadEventDetails(b.eventId)},a.loadMoreEvens=function(e){if((e||0===a.events.values.length||a.events.values.length!==a.events.total)&&(e&&(a.events={values:[],total:0,loading:!1}),!a.events.loading)){a.events.loading=!0;var f=c.Query(13,a.events.values.length,"*","EventDate desc,From desc",null,!0);b(function(){d.Private.Subjects.one("events").get(f).then(function(b){var c=b.values;a.events.firstLoad&&0!==c.length&&a.setSelected(c[0]),_.forEach(c,function(b){b.priceAdjusted=b.price/100,a.events.values.push(b)}),a.events.total=b.count,a.events.loading=!1,a.events.eventRecordsFound=0!==b.count})},300)}}}],link:function(){}}}),angular.module("edup.subjects").controller("SubjectsController",["$scope",function(a){a.subjectsView1="subjectsView1",a.subjectsView2="subjectsView2"}]),angular.module("edup.subjects").directive("subjects",function(){return{restrict:"E",templateUrl:"subjects",link:function(){}}}),angular.module("edup.subjects").directive("studentsAttendanceList",function(){return{restrict:"E",templateUrl:"students-attendance-list",controller:["$scope","$timeout","QueryService","RestService",function(a,b,c,d){a.resetEventStudentsSearch=function(b){a.eventStudentsSearch={spin:!1,formats:["Registered","All"],searchValue:"",values:[],total:0,attendance:[],studentRecordsFound:!0},a.eventStudentsSearch.format=b?a.eventStudentsSearch.formats[0]:a.eventStudentsSearch.formats[1]},a.mapAttendance=function(b){_.forEach(b,function(b){b.fullName=b.name+" "+b.lastName,b.active=!1,b.showAbsenceToggle=!1,_.forEach(a.eventStudentsSearch.attendance,function(a){b.id===a.studentId&&(b.active=!0,b.attendanceId=a.attendanceId,b.showAbsenceToggle=!0,b.participated=a.participated)})})};var e=function(b){var d=_.isEmpty(a.eventStudentsSearch.searchValue)?"*":a.eventStudentsSearch.searchValue,e=null,f=_.pluck(a.eventStudentsSearch.attendance,"studentId");switch(a.eventStudentsSearch.format){case"Registered":e="Id eq ("+(f||[]).join(",")+")";break;case"Not registered":e="Id ne ("+(f||[]).join(",")+")"}return c.Query(10,b,d,"Name asc, LastName asc",e)};a.executeSearch=function(){if(a.studentsManagemnt.expanded&&!a.eventStudentsSearch.spin){a.eventStudentsSearch.spin=!0;var c=e(0);b(function(){d.Private.Students.get(c).then(function(b){a.eventStudentsSearch.values=b.values,a.eventStudentsSearch.total=b.count,a.mapAttendance(a.eventStudentsSearch.values),a.eventStudentsSearch.spin=!1,a.eventStudentsSearch.studentRecordsFound=0!==b.count})},100)}},a.loadMoreStudents=function(){if(a.eventStudentsSearch&&!a.eventStudentsSearch.spin&&(0===a.eventStudentsSearch.values.length||a.eventStudentsSearch.values.length!==a.eventStudentsSearch.total)&&!a.eventStudentsSearch.spin&&a.studentsManagemnt.expanded){a.eventStudentsSearch.spin=!0;var b=e(a.eventStudentsSearch.values.length);d.Private.Students.get(b).then(function(b){var c=b.values;_.forEach(c,function(b){a.eventStudentsSearch.values.push(b)}),a.eventStudentsSearch.total=b.count,a.mapAttendance(c),a.eventStudentsSearch.spin=!1})}},a.updateStudentAttendance=function(b){b.attendanceId?d.Private.Subjects.one("events").one(a.selectedEvent.eventId.toString()).one("attendance").one(b.attendanceId.toString()).remove().then(function(){_.remove(a.eventStudentsSearch.attendance,function(a){return b.id===a.studentId}),a.eventStudentsSearch.format===a.eventStudentsSearch.formats[0]&&_.remove(a.eventStudentsSearch.values,function(a){return b.id===a.id}),b.attendanceId=null,a.selectedEvent.students-=1}):d.Private.Subjects.one("events").one(a.selectedEvent.eventId.toString()).one("attendance").customPOST({eventId:a.selectedEvent.eventId,studentId:b.id}).then(function(c){if(b.attendanceId=c.payload,a.selectedEvent.students+=1,a.selectedEvent.havePassed){b.showAbsenceToggle=!0;var d={attendanceId:c.payload,studentId:b.id,participated:!0,eventId:a.selectedEvent.eventId};a.eventStudentsSearch.attendance.push(d),b.participated=d.participated}})},a.formatChanged=function(){a.executeSearch()},a.onStudentAbsenceEvent=function(b){console.log(b.participated),b.attendanceId&&(b.updateInProgress=!0,d.Private.Subjects.one("events").one(a.selectedEvent.eventId.toString()).one("attendance").one(b.attendanceId.toString()).customPUT({eventId:a.selectedEvent.eventId,studentId:b.id,participated:b.participated}).then(function(){b.updateInProgress=!1},function(){b.updateInProgress=!1}))}}],link:function(){}}}),angular.module("edup.reports",[]),angular.module("edup.reports").directive("eventAttendanceModal",["$filter","UrlService",function(a,b){return{restrict:"E",templateUrl:"event-attendance-modal",controller:["$scope","$timeout","moment","RestService","TypeAheadService",function(a,b,c,d,e){a.plannedEventDetails={selectedSubject:null,dateFromPicker:null,dateToPicker:null};var f=function(b){a.plannedEventDetails.selectedSubject=_.find(e.DataSet(),function(a){return a.subjectName===b}),console.log(angular.toJson(a.selectedSubject))},g=e.Build(),h=$("#subject-event-typeahead-modal .typeahead");h.typeahead({hint:!0,highlight:!0,minLength:1},{name:"subjectsTypeAhead",source:g}),h.bind("typeahead:selected",function(a,b){f(b)}),a.plannedEventJournal=function(){a.plannedEventDetails={selectedSubject:null,dateFromPicker:null,dateToPicker:null,subjectName:null,showAttendance:!1}},a.finishedEventReport=function(){a.plannedEventDetails={selectedSubject:null,dateFromPicker:null,dateToPicker:null,subjectName:null,showAttendance:!0}}}],link:function(c){c.renderDatePicker=function(){},c.performReportDownload=function(d){if(d&&d.selectedSubject&&d.dateFromPicker&&d.dateToPicker){var e={from:a("date")(d.dateFromPicker,"ddMMyyyy"),to:a("date")(d.dateToPicker,"ddMMyyyy"),attendance:c.plannedEventDetails.showAttendance},f=b.Reports.Events+"/"+d.selectedSubject.subjectId+"?from="+e.from+"&to="+e.to+"&attendance="+e.attendance;window.open(f),c.dismissModal()}}}}}]),angular.module("edup.reports").controller("ReportsController",["$scope",function(){}]),angular.module("edup.tabs",["ngSanitize","toggle-switch","ui.bootstrap.datetimepicker","infinite-scroll","angularFileUpload","fiestah.money","edup.reports","edup.calendar","edup.subjects","edup.students"]),angular.module("edup",["edup.tabs","edup.login","edup.header","edup.footer","edup.common"]),angular.module("edup").config(["$stateProvider",function(a){a.state("students",{templateUrl:"students",url:"/students",controller:"StudentsController"}).state("subjects",{templateUrl:"subjects",url:"/subjects",controller:"SubjectsController"}).state("calendar",{templateUrl:"calendar",url:"/calendar",controller:"CalendarController"})}]),angular.module("edup").run(["$templateCache",function(a){a.put("edup-toggle","<input id={{toggleId}} type=checkbox data-toggle=toggle data-on={{onLabel}} data-off={{offLabel}} data-width=100 data-size=small>"),a.put("edup-footer",'<div ng-controller=FooterController><nav class="navbar navbar-default" style="margin-bottom: 0px !important; margin-top: auto !important"><div class="navbar-text text-center" style="width: 100%">Application version: {{ appVersion }}</div></nav></div>'),a.put("edup-header",'<div><nav class="navbar navbar-default"><div class=container-fluid><div class=navbar-header style="margin-right: 30px"><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button><div class=navbar-brand>Educational planning application: {{application.version}}</div></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li ng-class="{ active: isActive(\'/students\')}"><a href=#students>Students<span class=sr-only>(current)</span></a></li><li ng-class="{ active: isActive(\'/subjects\')}"><a href=#subjects>Subjects</a></li><li ng-controller=ReportsController class=dropdown><a href=#report class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Reports<span class=caret></span></a><ul class=dropdown-menu role=menu><li ng-click=plannedEventJournal() data-toggle=modal data-target=#eventAttendanceModalView><a href=#>Planned event journal</a></li><li ng-click=finishedEventReport() data-toggle=modal data-target=#eventAttendanceModalView><a href=#>Finished event report</a></li></ul></li></ul><ul class="nav navbar-nav navbar-right"><li><a href=# target=_self ng-click=logoutUser()>Log out</a></li></ul></div></div></nav></div><event-attendance-modal></event-attendance-modal>'),a.put("edup-login",'<div class=login-container><div id=output></div><div class=avatar></div><div class=form-box><form name=form method=post><input name=j_username placeholder=username id=text ng-model=username required> <input type=password name=j_password placeholder=password id=password ng-model=password required> <button class="btn btn-info btn-block login" type=submit ng-click="submitLogin(username, password)">Login</button></form></div></div>'),a.put("calendar",'<div class=mainForm ng-controller=CalendarController><div class="col-md-12 column"><div class="col-md-3 form-inline"><div class="btn-group pull-left"><button class="btn btn-primary btn-sm" ng-click=updateTitle() mwl-date-modifier date=calendarDay decrement=calendarView>&lt;&lt; Prev</button> <button class="btn btn-sm" ng-click=updateTitle() mwl-date-modifier date=calendarDay set-to-today>Today</button> <button class="btn btn-primary btn-sm" ng-click=updateTitle() mwl-date-modifier date=calendarDay increment=calendarView>Next &gt;&gt;</button></div></div><div class=col-md-2><div class=btn-group><h4>{{ currentDay }}</h4></div></div><div class="col-md-3 form-inline"><div class="btn-group pull-right"><button class="btn btn-primary btn-sm" ng-click="setCalendarView(\'year\')">Year</button> <button class="btn btn-primary btn-sm" ng-click="setCalendarView(\'month\')">Month</button> <button class="btn btn-primary btn-sm" ng-click="setCalendarView(\'week\')">Week</button> <button class="btn btn-primary btn-sm" ng-click="setCalendarView(\'day\')">Day</button></div></div><div class="col-md-4 form-inline"><h4>Today events:</h4></div></div><div class="col-md-12 column" style="padding-top: 20px"><div class="col-md-8 column"><mwl-calendar events=events view=calendarView view-title=calendarTitle current-day=calendarDay on-event-click=eventClicked(calendarEvent) edit-event-html="\'<i class=\\\'glyphicon glyphicon-pencil\\\'></i>\'" delete-event-html="\'<i class=\\\'glyphicon glyphicon-remove\\\'></i>\'" on-edit-event-click=eventEdited(calendarEvent) on-delete-event-click=eventDeleted(calendarEvent)></mwl-calendar></div><div class="col-md-4 column"><div ng-repeat="event in events"><h4><div class=label ng-class="{ \'label-primary\': event.type === \'info\', \'label-warning\': event.type === \'warning\', \'label-danger\': event.type === \'important\'}" data-toggle=tooltip data-placement=top title="Tooltip on top" tooltip="{{ event.title }}" tooltip-trigger="{{{true: \'mouseenter\', false: \'never\'}[myForm.username.$invalid]}}">({{event.startsAt| date:\'HH:mm\'}} - {{event.endsAt | date:\'HH:mm\'}}) {{event.title | limitTo: 33}} {{event.title.length > 33 ? \'...\' : \'\'}}</div></h4></div></div></div></div>'),a.put("event-attendance-modal",'<div app-modal id=eventAttendanceModalView class="modal fade" tabindex=-1 role=dialog aria-labelledby=mySmallModalLabel aria-hidden=true><div class="modal-dialog modal-sm"><div class="modal-content modalViewPadding"><form role=form name=EventAttendanceForm><div class=row><div class=form-group id=subject-event-typeahead-modal><div class=input-group id=subjectTypeAheadInput><span class=input-group-addon id=basic-addon2 ng-class="{\'glyphicon glyphicon-ok searchTextInput\': !selectedSubject , \'glyphicon glyphicon-pencil searchTextInput\': !!selectedSubject}"></span><div id=scrollable-dropdown-menu><input required class="form-control typeahead tt-query" placeholder=Subject ng-model=plannedEventDetails.subjectName ng-keyup=updateSelectedSubject()></div></div></div></div><div class=row><div class=form-group><div class=dropdown><a class=dropdown-toggle id=subjectEventDatefromIdModal role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input required datepicker-popup=yyyy-MM-dd class=form-control data-ng-model=plannedEventDetails.dateFromPicker placeholder=From> <span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=plannedEventDetails.dateFromPicker data-before-render="renderDatePicker($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: \'#subjectEventDatefromIdModal\' , startView:\'day\', minView:\'day\'}"></datetimepicker></ul></div></div></div><div class=row><div class=form-group><div class=dropdown><a class=dropdown-toggle id=subjectEventDateToIdModal role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input required datepicker-popup=yyyy-MM-dd class=form-control data-ng-model=plannedEventDetails.dateToPicker placeholder=To> <span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=plannedEventDetails.dateToPicker data-before-render="renderDatePicker($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: \'#subjectEventDateToIdModal\' , startView:\'day\', minView:\'day\'}"></datetimepicker></ul></div></div></div><div class=row><button style="margin-top: 10px" class="btn btn-success btn-sm pull-right" type=button ng-click=performReportDownload(plannedEventDetails)>Submit</button></div></form></div></div></div>'),a.put("student-accounting",'<div class=mainForm style="margin-left: 30px; margin-right: 30px"><div class="row clearfix"><div class="col-md-12 column"><form role=form name=studentBalanceUpdate><div class=form-group><label for=amount>Enter a monetary amount:</label><div class=input-group><span class=input-group-addon>&euro;</span> <input id=amount class=form-control money="" ng-model=balance.amount autofocus precision=2></div></div><div class=form-group><label for=comments>Comments</label><textarea ng-model=balance.comment class="form-control fixedTextArea" id=comments name=comments></textarea></div><div class="form-group col-md-12 column"><div class="col-md-6 column"><label><input type=radio name=operationType value=true ng-model=balance.cash ng-checked=true> Cash</label></div><div class="col-md-6 column"><label><input type=radio name=operationType value=false ng-model=balance.cash> Transfer</label></div></div><div class="form-group text-center"><button ng-click="updateStudentBalance(balance, selectedStudent)" id=addToBalanceButton class="btn btn-success btn-sm">Save</button> <button ng-click=resetValue() id=clearBalanceUpdate type=reset class="btn btn-primary btn-sm">Reset</button></div></form></div></div></div>'),a.put("student-attendance",'<div class=mainForm style="margin-left: 30px; margin-right: 30px"><div class=row><div class=col-md-12><h3>Under development</h3></div></div></div>'),a.put("balance-modal",'<div app-modal id=addToBalanceModalView class="modal fade bs-example-modal-sm" tabindex=-1 role=dialog aria-labelledby=mySmallModalLabel aria-hidden=true><div class="modal-dialog modal-sm"><div class="modal-content modalViewPadding"><form><fieldset><legend>Add money to account</legend><div class=form-group><label for=amount>Enter a monetary amount:</label><div class=input-group><span class=input-group-addon>&euro;</span> <input required id=amount class=form-control money="" ng-model=balance.amount autofocus precision=2></div></div><div class=form-group><label for=comments>Comments</label><textarea ng-model=balance.comment class="form-control fixedTextArea" id=comments name=comments></textarea></div><div class="form-group col-md-12 column"><div class="col-md-6 column"><label><input type=radio name=operationType value=true ng-model=balance.cash ng-checked=true> Cash</label></div><div class="col-md-6 column"><label><input type=radio name=operationType value=false ng-model=balance.cash> Transfer</label></div></div><div ng-init="balanceUpdateInProgress = false" class="form-group text-center"><button ng-click=saving(balance) id=addToBalanceButton ng-disabled=balanceUpdateInProgress class="btn btn-success btn-sm">Save</button> <button ng-click=resetValue() id=clearBalanceUpdate type=reset ng-disabled=balanceUpdateInProgress class="btn btn-primary btn-sm">Reset</button> <button id=cancelBalanceUpdate class="btn btn-warning btn-sm" data-dismiss=modal ng-disabled=balanceUpdateInProgress ng-click="balance = null">Cancel</button></div></fieldset></form></div></div></div>'),a.put("student-details",'<div app-modal id=student-details-modal-view class="modal fade bs-example-modal-lg" tabindex=-1 role=dialog aria-labelledby=myLargeModalLabel aria-hidden=true><div class="modal-dialog modal-lg"><div class="modal-content modalViewPadding"><div class=modal-header style="padding: 5px !important;border-bottom: none !important"><div class="parent modal-title" id=myModalLabel><div class="child pull=left"><h4>{{selectedStudent.name}} {{selectedStudent.lastName}}</h4></div><div class="child pull-right"><h4 class=pull-right><span class=label style="font-weight: 200 !important" ng-class="{\'label-danger\' :  selectedStudent.balance < 0, \'label-success\' :  selectedStudent.balance > 0, \'label-primary\' :  selectedStudent.balance == 0}">{{ selectedStudent.balance | number : 2}} EUR</span></h4></div></div></div><div role=tabpanel><ul class="nav nav-tabs" role=tablist style="border: none !important"><li role=presentation class=active ng-class="{ active: isActive(\'/information\')}"><a href=#information aria-controls=home role=tab data-toggle=tab>Information</a></li><li role=presentation ng-class="{ active: isActive(\'/accounting\')}"><a href=#accounting aria-controls=profile role=tab data-toggle=tab>Accounting</a></li><li role=presentation ng-class="{ active: isActive(\'/documents\')}" ng-click=refreshDocumentsList()><a href=#documents aria-controls=messages role=tab data-toggle=tab>Documents</a></li><li role=presentation ng-class="{ active: isActive(\'/attendance\')}"><a href=#attendance aria-controls=settings role=tab data-toggle=tab>Attendance</a></li></ul><div class=tab-content style="margin-bottom: 10px"><div role=tabpanel class="tab-pane active first-tab" id=information><edit-student></edit-student></div><div role=tabpanel class="tab-pane next-tab" id=accounting><student-accounting></student-accounting></div><div role=tabpanel class="tab-pane next-tab" id=documents><student-documents></student-documents></div><div role=tabpanel class="tab-pane next-tab" id=attendance><student-attendance></student-attendance></div></div></div></div></div></div>'),a.put("student-documents",'<div class=mainForm style="margin-left: 30px; margin-right: 30px"><div class="row clearfix"><div class="col-md-12 column"><table class="table table-hover"><thead><tr><th>Name</th><th>Size</th><th>Created</th><th></th></tr></thead><tbody><tr dir-paginate="document in documents | itemsPerPage: documentsPaging.perPage" current-page=documentsPaging.page total-items=documentsPaging.totalRecords ng-class-odd="\'success\'" ng-class-even="\'active\'" pagination-id=documentsPaginationId><td>{{ document.fileName }}</td><td>{{ document.size }}</td><td>{{ document.created | date:\'MMM d, y HH:mm\' }}</td><td><a href="{{ document.link }}">Download</a></td></tr></tbody></table><div class=row><div class="col-xs-12 text-center"><dir-pagination-controls on-page-change="documentsPageChanged(newPageNumber, searchValue)" pagination-id=documentsPaginationId></dir-pagination-controls></div></div></div><div style="padding-bottom: 20px"><button type=button class="btn btn-primary btn-sm pull-right" ng-click=toggleDownloadSection()>{{documentsButtonLabel}}</button></div><div ng-show=showDownloadSection><file-upload></file-upload></div></div></div>'),a.put("edit-student",'<div class=mainForm><div class="row clearfix"><form role=form name=studentUpdateForm><div class="col-md-6 column"><div class="col-md-6 column"><div class=form-group><label for=studentName>Name</label><input class=form-control id=studentName ng-model=studentEdit.name required></div><div class=form-group><label for=studentLastName>Last name</label><input type=tel class=form-control id=studentLastName ng-model=studentEdit.lastName required></div></div><div class="col-md-6 column"><div class=form-group><label for=studentMobile>Mobile</label><input class=form-control id=studentMobile ng-model="studentEdit.mobile"></div><div class=form-group><label for=studentPersonalNumber>Personal number</label><input class=form-control id=studentPersonalNumber ng-model="studentEdit.personId"></div></div><div class="col-md-12 column"><div class=form-group><label for=parentInformationInput>Parent information</label><textarea ng-model=studentEdit.parentsInfo class="form-control fixedTextArea" id=parentInformationInput name=parentInformationInput></textarea></div><div class=form-group><label for=characteristicsInput>Characteristics</label><textarea ng-model=studentEdit.characteristics class="form-control fixedTextArea" id=characteristicsInput name=characteristicsInput></textarea></div></div></div><div class="col-md-6 column"><div class="col-md-12 column"><div class=form-group><label for=studentMail>e-mail</label><input class=form-control id=studentMail ng-model="studentEdit.mail"></div><div class=dropdown><label for=editStudentDatePicker>Birthdate</label><a class=dropdown-toggle id=editStudentDatePicker role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input datepicker-popup=yyyy-MM-dd class=form-control data-ng-model=studentEdit.birthDateString placeholder=Birthdate> <span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=studentEdit.birthDateString data-datetimepicker-config="{ dropdownSelector: \'#editStudentDatePicker\' , startView:\'day\', minView:\'day\'}"></datetimepicker></ul></div></div><div class="col-md-12 row"><photo-upload photo-id=studentEdit.photoId photo-url=studentEdit.photoUrl></photo-upload></div></div><div ng-init="studentProcessingInProgress = false" class="col-md-12 column" style="margin-top: 10px; margin-left: 17px"><button type=submit ng-disabled=studentProcessingInProgress class="btn btn-primary btn-sm" ng-click=executeStudentUpdate(studentEdit)>Update</button></div></form></div></div>'),a.put("file-upload",'<div ng-if=uploader><input type=file nv-file-select uploader=uploader multiple></div><table class=table><thead><tr><th width=50%>Name</th><th ng-show=uploader.isHTML5>Size</th><th ng-show=uploader.isHTML5>Progress</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr ng-repeat="item in uploader.queue"><td><strong>{{ item.file.name }}</strong></td><td ng-show=uploader.isHTML5 nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td><td ng-show=uploader.isHTML5><div class=progress style="margin-bottom: 0"><div class=progress-bar role=progressbar ng-style="{ \'width\': item.progress + \'%\' }"></div></div></td><td class=text-center><span ng-show=item.isSuccess><i class="glyphicon glyphicon-ok"></i></span> <span ng-show=item.isCancel><i class="glyphicon glyphicon-ban-circle"></i></span> <span ng-show=item.isError><i class="glyphicon glyphicon-remove"></i></span></td><td nowrap><button type=button class="btn btn-success btn-xs" ng-click=item.upload() ng-disabled="item.isReady || item.isUploading || item.isSuccess"><span class="glyphicon glyphicon-upload"></span> Upload</button> <button type=button class="btn btn-warning btn-xs" ng-click=item.cancel() ng-disabled=!item.isUploading><span class="glyphicon glyphicon-ban-circle"></span> Cancel</button> <button type=button class="btn btn-danger btn-xs" ng-click=item.remove()><span class="glyphicon glyphicon-trash"></span> Remove</button></td></tr></tbody></table><div><div>Queue progress:<div class=progress><div class=progress-bar role=progressbar ng-style="{ \'width\': uploader.progress + \'%\' }"></div></div></div><button type=button class="btn btn-success btn-sm" ng-click=uploader.uploadAll() ng-disabled=!uploader.getNotUploadedItems().length><span class="glyphicon glyphicon-upload"></span> Upload All</button> <button type=button class="btn btn-warning btn-sm" ng-click=uploader.cancelAll() ng-disabled=!uploader.isUploading><span class="glyphicon glyphicon-ban-circle"></span> Cancel All</button> <button type=button class="btn btn-danger btn-sm" ng-click=uploader.clearQueue() ng-disabled=!uploader.queue.length><span class="glyphicon glyphicon-trash"></span> Remove All</button></div>'),a.put("student-identification-card",'<div><div class=form-horizontal><div><div class="col-md-6 column"><div tooltip="{{selectedStudent.name }}" class=tooltip-300max tooltip-enable="selectedStudent.name.length > 25"><h4><b>{{ selectedStudent.name | limitTo: 25}}{{selectedStudent.name.length > 25 ? \'...\' : \'\'}}</b></h4></div><div tooltip="{{selectedStudent.lastName }}" class=tooltip-300max tooltip-enable="selectedStudent.lastName.length > 25"><h4><b>{{ selectedStudent.lastName | limitTo: 25}}{{selectedStudent.lastName.length > 25 ? \'...\' : \'\'}}</b></h4></div><div><h4>{{ selectedStudent.personId }}</h4></div></div><div class="col-md-6 column"><img alt=140x140 width=140 height=140 src={{selectedStudent.photoUrl}} class="img-rounded pull-right"></div></div><div class="col-md-12 column" style="padding-top: 20px"><table class=identification-card width=100%><tr><td>Phone number:</td><td>{{ selectedStudent.mobile }}</td></tr><tr><td>Current balance:</td><td>{{ selectedStudent.balance | number : 2}} EUR</td><td><button type=button class="btn btn-success btn-sm pull-right" data-toggle=modal data-target=#addToBalanceModalView>Add to balance</button></td></tr></table></div><div ng-show=false class="col-md-12 column" style="padding-top: 10px"><button type=button class="btn btn-success btn-sm" style="width: 100%">Attendance history</button></div></div><balance-modal></balance-modal></div>'),a.put("students-list-header",'<div class=container-fluid><div class=row><div class="col-md-8 column"><div class=input-group><span class=input-group-addon id=basic-addon1 ng-class="{\'glyphicon glyphicon-refresh searchTextInput\': basicSearch.spin , \'glyphicon glyphicon-search searchTextInput\': !basicSearch.spin}"></span> <input class=form-control placeholder=search ng-model=searchValue ng-keyup=executeSearch(searchValue)></div></div><div class="col-md-3 column"><div class="btn-group btn-group-sm" role=group><button type=button class="btn btn-default" ng-class="{ active: studentPaging.perPage === 10}" ng-click=setRecordsPerPage(10)>10</button> <button type=button class="btn btn-default" ng-class="{ active: studentPaging.perPage === 25}" ng-click=setRecordsPerPage(25)>25</button> <button type=button class="btn btn-default" ng-class="{ active: studentPaging.perPage === 50}" ng-click=setRecordsPerPage(50)>50</button></div></div><div class=col-md-1><h3><span class="glyphicon glyphicon-plus pull-right" style="cursor: pointer;position: absolute; padding-top: 5px" data-toggle=modal data-target=#addNewStudentModalView ng-click=resetNewStudent()></span></h3></div></div><new-student></new-student></div>'),a.put("students-list",'<div class=container-fluid style="padding-top: 20px"><div ng-show=!studentsSearch.studentRecordsFound><div class="jumbotron well"><h3>No students found!</h3><p>Change search query for result.</p></div></div><table ng-show=studentsSearch.studentRecordsFound class="table table-hover" style=table-layout:fixed><thead><tr><th>Name</th><th class=text-center>Age</th><th class=text-center>ID</th><th class=text-center>Phone</th><th></th></tr></thead><tbody><tr dir-paginate="student in students | itemsPerPage: studentPaging.perPage" current-page=studentPaging.page total-items=studentPaging.totalRecords ng-class-odd="\'success\'" ng-class-even="\'active\'" ng-click=setSelected(student.id) ng-class="{\'missing-data-row\': !student.mobile, \'selected-row\': student.id === selectedStudent.id}" pagination-id=studentsPaginationId><td style="width: 50%!important;word-wrap:break-word"><div tooltip="{{student.fullName }}" class=tooltip-300max tooltip-enable="student.fullName.length > 30">{{ student.fullName | limitTo: 30}}{{student.fullName.length > 30 ? \'...\' : \'\'}}</div></td><td style="width: 10%!important" class=text-center>{{ student.age }}</td><td style="width: 10%!important;word-wrap:break-word" class=text-center>{{ student.personId }}</td><td style="width: 10%!important;word-wrap:break-word" class=text-center>{{ student.mobile }}</td><td style="width: 10%!important" class=text-center><button href=#information type=button class="btn btn-success btn-xs" ng-click=openStudentDetailModal(student)>Details</button></td></tr></tbody></table><div class=row><div class="col-xs-12 text-center"><dir-pagination-controls on-page-change="studentsPageChanged(newPageNumber, searchValue)" pagination-id=studentsPaginationId></dir-pagination-controls></div></div><student-details></student-details></div>'),a.put("students",'<div class=mainForm ng-controller=StudentsController><div class="row clearfix"><div ng-class="{\'col-md-7 column\' :  studentsSearch.studentRecordsFound, \'col-md-12 column\' :  !studentsSearch.studentRecordsFound}"><div class="panel panel-success"><div class="panel-heading panel-success-override">Students</div><div class="panel-body panel-body-override"><div class=row><students-list-header></students-list-header></div><div class=row><students-list></students-list></div></div></div></div><div ng-show=studentsSearch.studentRecordsFound class="col-md-5 column"><div class=row><div class="panel panel-success"><div class="panel-heading panel-success-override">Identification card</div><div class="panel-body panel-body-override" ng-show=studentSelected><student-identification-card></student-identification-card></div></div></div><div class=row><div class="panel panel-success"><div class="panel-heading panel-success-override">Transactions history</div><div class="panel-body panel-body-override" ng-show=studentSelected><div class=row><div class=col-md-12><h3>Under development</h3></div></div></div></div></div><div class=row><div class="panel panel-success"><div class="panel-heading panel-success-override">Latest files</div><div class="panel-body panel-body-override" ng-show=studentSelected><div class=row><div class=col-md-12><h3>Under development</h3></div></div></div></div></div></div></div></div>'),a.put("new-student-modal",'<div app-modal id=addNewStudentModalView class="modal fade bs-example-modal-lg" tabindex=-1 role=dialog aria-labelledby=myLargeModalLabel aria-hidden=true><div class="modal-dialog modal-lg"><div class="modal-content modalViewPadding"><div class=modal-header><button type=button class=close data-dismiss=modal aria-hidden=true><span class="glyphicon glyphicon-remove"></span></button><h4 class=modal-title id=myModalLabel>Add new student</h4></div><div style="padding-top: 20px; padding-bottom: 10px"><div class="row clearfix"><form role=form name=studentCreatedForm><div class="col-md-6 column"><div class="col-md-6 column"><div class=form-group><label for=studentName>Name</label><input class=form-control id=studentName ng-model=newStudent.name required></div><div class=form-group><label for=studentLastName>Last name</label><input type=tel class=form-control id=studentLastName ng-model=newStudent.lastName required></div></div><div class="col-md-6 column"><div class=form-group><label for=studentMobile>Mobile</label><input class=form-control id=studentMobile ng-model="newStudent.mobile"></div><div class=form-group><label for=studentPersonalNumber>Personal number</label><input placeholder=123456-12345 class=form-control id=studentPersonalNumber ng-model="newStudent.personId"></div></div><div class="col-md-12 column"><div class=form-group><label for=parentInformationInput>Parent information</label><textarea ng-model=newStudent.parentsInfo class="form-control fixedTextArea" id=parentInformationInput name=parentInformationInput></textarea></div><div class=form-group><label for=characteristicsInput>Characteristics</label><textarea ng-model=newStudent.characteristics class="form-control fixedTextArea" id=characteristicsInput name=characteristicsInput></textarea></div></div></div><div class="col-md-6 column"><div class="col-md-12 column"><div class=form-group><label for=studentMail>e-mail</label><input class=form-control id=studentMail ng-model="newStudent.mail"></div><div class=dropdown><label for=newStudentDatePicker>Birthdate</label><a class=dropdown-toggle id=newStudentDatePicker role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input datepicker-popup=yyyy-MM-dd class=form-control data-ng-model=newStudent.birthDateString placeholder=Birthdate> <span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=newStudent.birthDateString data-datetimepicker-config="{ dropdownSelector: \'#newStudentDatePicker\' , startView:\'day\', minView:\'day\'}"></datetimepicker></ul></div></div><div class="col-md-12 row"><photo-upload photo-id=newStudent.photoId photo-url=newStudent.photoUrl></photo-upload></div></div><div ng-init="studentProcessingInProgress = false" class="col-md-12 column" style="padding-top: 10px"><button type=submit ng-disabled=studentProcessingInProgress class="btn btn-success btn-sm" ng-click=executeStudentSave(newStudent)>Save</button> <button type=reset ng-disabled=studentProcessingInProgress class="btn btn-primary btn-sm" ng-click=executeReset()>Reset</button> <button type=reset ng-disabled=studentProcessingInProgress class="btn btn-warning btn-sm" ng-click=executeCancel()>Cancel</button></div></form></div></div></div></div></div>'),a.put("photo-upload",'<div style="padding: 10px"><div><div ng-if=uploader><input id=photoUploader ng-disabled=photoIsSelected type=file nv-file-select uploader="uploader"></div></div><table class=table><thead><tr><th width=50%>Name</th><th ng-show=uploader.isHTML5>Size</th><th ng-show=uploader.isHTML5>Progress</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr ng-repeat="item in uploader.queue"><td><strong>{{ item.file.name }}</strong></td><td ng-show=uploader.isHTML5 nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td><td ng-show=uploader.isHTML5><div class=progress style="margin-bottom: 0"><div class=progress-bar role=progressbar ng-style="{ \'width\': item.progress + \'%\' }"></div></div></td><td class=text-center><span ng-show=item.isSuccess><i class="glyphicon glyphicon-ok"></i></span> <span ng-show=item.isCancel><i class="glyphicon glyphicon-ban-circle"></i></span> <span ng-show=item.isError><i class="glyphicon glyphicon-remove"></i></span></td><td nowrap><button type=button class="btn btn-success btn-xs" ng-click=item.upload() ng-disabled="item.isReady || item.isUploading || item.isSuccess"><span class="glyphicon glyphicon-upload"></span></button> <button type=button class="btn btn-warning btn-xs" ng-click=item.cancel() ng-disabled=!item.isUploading><span class="glyphicon glyphicon-ban-circle"></span></button> <button type=button class="btn btn-danger btn-xs" ng-click=handleItemRemoval(item)><span class="glyphicon glyphicon-trash"></span></button></td></tr></tbody></table></div><div ng-show=photoUrl><img alt=140x140 width=140 height=140 src={{photoUrl}} class="img-rounded text-center"></div>'),a.put("event-info",'<div class="panel panel-success"><div class="panel-heading panel-success-override">Event information</div><div class="panel-body panel-body-override container-fluid"><div class=row><div class=col-md-12><div class=row><div class=col-md-8><table><tr><td><b>Subject name:</b></td><td style="padding-left: 10px">{{selectedEvent.subject.subjectName}}</td></tr><tr><td><b>Event date:</b></td><td style="padding-left: 10px">{{selectedEvent.eventDate | date:\'yyyy/MM/dd\'}}</td></tr><tr><td><b>Time:</b></td><td style="padding-left: 10px">{{selectedEvent.from | date:\'HH:mm\'}} - {{selectedEvent.to | date:\'HH:mm\'}}</td></tr><tr><td><b>Price:</b></td><td style="padding-left: 10px">{{selectedEvent.adjustedPrice | number : 2}} &euro;</td></tr></table></div><div class=col-md-4><div class=pull-right ng-show=selectedEvent.loaded><div>Students <span class=badge>{{selectedEvent.students}}</span></div></div></div></div></div></div><div class=row><div class=col-md-12><div class=pull-right><button class="btn btn-success btn-sm" type=button data-toggle=collapse data-target=#studentManageView aria-expanded=false aria-controls=studentManageView ng-click=processExpand()>Manage</button></div></div></div><div class=collapse id=studentManageView style="margin-top: 15px"><students-attendance-list></students-attendance-list></div></div></div>'),a.put("events-header",'<div class=container-fluid><form role=form name=newSubjectEventForm><div class=row><div class="col-md-8 column"><div class=form-group id=subject-event-typeahead><div class=input-group id=subjectTypeAheadInput><span class=input-group-addon id=basic-addon2 ng-class="{\'glyphicon glyphicon-ok searchTextInput\': !selectedSubject , \'glyphicon glyphicon-pencil searchTextInput\': !!selectedSubject}"></span><div id=scrollable-dropdown-menu><input required class="form-control typeahead tt-query" placeholder=Subject ng-model=subjectEvent.subjectName ng-keyup=updateSelectedSubject()></div></div></div></div><div class="col-md-4 column"><div class=form-group><div class=input-group><span class=input-group-addon>&euro;</span> <input required id=amount class="form-control ng-valid ng-valid-min ng-dirty ng-valid-number" money="" ng-model=subjectEvent.amount autofocus placeholder=Amount precision=2></div></div></div></div><div class=row><div class="col-md-4 column"><div class=form-group><div class=dropdown><a class=dropdown-toggle id=subjectEventDateId role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input required datepicker-popup=yyyy-MM-dd class=form-control data-ng-model=subjectEvent.eventDate placeholder="Event date"> <span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=subjectEvent.eventDate data-before-render="renderDatePicker($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: \'#subjectEventDateId\' , startView:\'day\', minView:\'day\'}"></datetimepicker></ul></div></div></div><div class="col-md-4 column"><div class=form-group><div class=dropdown><a class=dropdown-toggle id=subjectEventTimeFromId role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input required datepicker-popup=HH:mm class=form-control data-ng-model=subjectEvent.eventTimeFrom placeholder="Time from"> <span class=input-group-addon><i class="glyphicon glyphicon-time"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=subjectEvent.eventTimeFrom data-before-render="renderTimePicker($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: \'#subjectEventTimeFromId\' , startView:\'hour\', minView:\'minute\'}"></datetimepicker></ul></div></div></div><div class="col-md-4 column"><div class=form-group><div class=dropdown><a class=dropdown-toggle id=subjectEventTimeToId role=button data-toggle=dropdown data-target=# href=#><div class=input-group><input required datepicker-popup=HH:mm class=form-control data-ng-model=subjectEvent.eventTimeTo placeholder="Time till"> <span class=input-group-addon><i class="glyphicon glyphicon-time"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=subjectEvent.eventTimeTo data-before-render="renderTimePicker($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: \'#subjectEventTimeToId\' , startView:\'hour\', minView:\'minute\', minuteStep: 10}"></datetimepicker></ul></div></div></div></div><div class=row><div class="col-md-3 column"><div class=form-group><button style="width: 100%" type=submit class="btn btn-success btn-sm" ng-click=saveNewEvent(subjectEvent)>Save</button></div></div></div></form></div>'),a.put("events-list",'<div class=container-fluid><div id=events_list_contaner style="height:400px;overflow: auto"><div ng-show=!events.eventRecordsFound><div class="jumbotron well"><h3>No events found!</h3><p>Please register new event.</p></div></div><table ng-show=events.eventRecordsFound class="table table-hover"><thead><tr><th>Name</th><th>Date</th><th>From</th><th>To</th></tr></thead><tbody><div infinite-scroll=loadMoreEvens(false) infinite-scroll-distance=3 infinite-scroll-container="\'#events_list_contaner\'"><tr ng-repeat="event in events.values" ng-class-odd="\'success\'" ng-class-even="\'active\'" ng-class="{\'selected-row\': event.eventId === selectedEvent.eventId}" ng-click=setSelected(event)><td>{{ event.subject.subjectName }}</td><td>{{ event.eventDate | date:\'yyyy/MM/dd\'}}</td><td>{{ event.from | date:\'HH:mm\'}}</td><td>{{ event.to | date:\'HH:mm\'}}</td></tr></div></tbody></table></div></div>'),a.put("subjects",'<div class=mainForm ng-controller=SubjectsController><div class="row clearfix"><div class="col-md-6 column"><div class="panel panel-success"><div class="panel-heading panel-success-override">Events list</div><div class="panel-body panel-body-override"><div class=row><events-header></events-header></div><div class=row><events-list></events-list></div></div></div></div><div class="col-md-6 column"><event-info></event-info></div></div></div>'),a.put("students-attendance-list",'<div style=height:418px><div class=row><div class=col-md-8><div class=input-group><span class=input-group-addon id=basic-addon1 ng-class="{\'glyphicon glyphicon-refresh searchTextInput\': eventStudentsSearch.spin , \'glyphicon glyphicon-search searchTextInput\': !eventStudentsSearch.spin}"></span> <input class=form-control placeholder=search ng-model=eventStudentsSearch.searchValue ng-keyup=executeSearch()></div></div><div class=col-md-4><div class="dropdown pull-right" style="width: 100% !important"><select id=formatId class=form-control ng-model=eventStudentsSearch.format ng-options="format for format in eventStudentsSearch.formats" ng-change=formatChanged()></select></div></div></div><div class=row><div class=col-md-12><div id=events_students_contaner style="height:340px;overflow: auto;margin-top: 10px"><div ng-show=!eventStudentsSearch.studentRecordsFound><div class="jumbotron well"><h3>No students found!</h3><p>Please select another event or change search filter.</p></div></div><table ng-show=eventStudentsSearch.studentRecordsFound class="table table-hover"><thead><tr><th>Name</th><th class=text-center>ID</th><th class=text-center>Registered</th><th class=text-center ng-show=selectedEvent.havePassed>Participated</th></tr></thead><tbody><div infinite-scroll=loadMoreStudents() nfinite-scroll-distance=4 infinite-scroll-container="\'#events_students_contaner\'"><tr ng-repeat="student in eventStudentsSearch.values" ng-class-odd="\'success\'" ng-class-even="\'active\'"><td style=width:30%><div tooltip={{student.fullName}} tooltip-enable="student.fullName.length > 25" class=tooltip-300max>{{ student.fullName | limitTo: 25}}{{student.fullName.length > 25 ? \'...\' : \'\'}}</div></td><td class=text-center>{{ student.personId}}</td><td style=width:50px class=text-center><input type=checkbox name=checkboxes id=registeredStudentId ng-checked=student.active ng-click="updateStudentAttendance(student)"></td><td style=width:50px ng-show=selectedEvent.havePassed><div ng-show=student.showAbsenceToggle toggle-switch ng-init="student.updateInProgress = false" is-disabled=student.updateInProgress class="switch-success switch-mini" on-label=Yes off-label=No knob-label="" ng-model=student.participated ng-change=onStudentAbsenceEvent(student)></div></td></tr></div></tbody></table></div></div></div><button style="margin-top: 10px" class="btn btn-success btn-sm pull-right" type=button ng-click="">Confirm finished</button></div>')
}]);